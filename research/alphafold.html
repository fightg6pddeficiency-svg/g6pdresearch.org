<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaFold Analysis | G6PD Research</title>
    <meta name="description" content="AlphaFold-predicted structure analysis of G6PD protein and disease-causing variants.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- 3Dmol.js for protein visualization -->
    <script src="https://3dmol.org/build/3Dmol-min.js"></script>

    <!-- Shared Styles -->
    <link rel="stylesheet" href="../css/styles.css">

    <style>
        .alphafold-hero {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            padding: 120px 1rem 60px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        @media (min-width: 768px) {
            .alphafold-hero {
                padding: 150px 2rem 80px;
            }
        }

        .alphafold-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%234361ee' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .confidence-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(67, 97, 238, 0.2);
            border: 1px solid rgba(67, 97, 238, 0.3);
            padding: 8px 16px;
            border-radius: 50px;
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
        }

        .viewer-container {
            background: white;
            border-radius: var(--radius-xl);
            padding: 1.5rem;
            box-shadow: var(--shadow-lg);
            margin-top: -60px;
            position: relative;
            z-index: 10;
        }

        @media (min-width: 768px) {
            .viewer-container {
                padding: 2rem;
            }
        }

        .protein-viewer {
            width: 100%;
            height: 350px;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%);
            border-radius: var(--radius);
            position: relative;
            overflow: hidden;
        }

        @media (min-width: 768px) {
            .protein-viewer {
                height: 500px;
            }
        }

        .viewer-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .view-btn {
            padding: 8px 16px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .view-btn:hover {
            background: var(--bg-alt);
        }

        .view-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .confidence-scale {
            display: flex;
            gap: 0;
            margin-top: 1rem;
            border-radius: var(--radius);
            overflow: hidden;
        }

        .confidence-level {
            flex: 1;
            padding: 12px 8px;
            text-align: center;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .confidence-level.very-high { background: #0053d6; color: white; }
        .confidence-level.high { background: #65cbf3; color: #0a0a0a; }
        .confidence-level.low { background: #ffdb13; color: #0a0a0a; }
        .confidence-level.very-low { background: #ff7d45; color: white; }

        .structure-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }

        @media (min-width: 768px) {
            .structure-info {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .info-card {
            background: var(--bg-alt);
            padding: 1rem;
            border-radius: var(--radius);
            text-align: center;
        }

        .info-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .info-label {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 4px;
        }

        .domain-card {
            background: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary);
        }

        .domain-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .domain-name {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .domain-range {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            background: var(--primary-light);
            color: var(--primary);
            padding: 4px 10px;
            border-radius: 4px;
        }

        .interactive-residue {
            display: inline-block;
            padding: 4px 8px;
            margin: 2px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            background: var(--bg-alt);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .interactive-residue:hover {
            background: var(--primary);
            color: white;
        }

        .interactive-residue.active-site {
            background: #fef3c7;
            border: 1px solid #f59e0b;
        }

        .interactive-residue.mutation-site {
            background: #fee2e2;
            border: 1px solid #ef4444;
        }

        /* Animated helix background */
        .helix-animation {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.1;
        }

        .helix-strand {
            position: absolute;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, transparent, #4361ee, transparent);
            animation: helixMove 3s ease-in-out infinite;
        }

        @keyframes helixMove {
            0%, 100% { transform: translateY(-20px) rotate(0deg); }
            50% { transform: translateY(20px) rotate(180deg); }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav id="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">
                <div class="logo-icon">G6</div>
                <span>G6PD Research</span>
            </a>
            <ul class="nav-links">
                <li><a href="../about.html">About</a></li>
                <li class="nav-dropdown">
                    <a href="../research.html" class="dropdown-toggle active">
                        Research <i data-lucide="chevron-down" style="width: 14px; height: 14px;"></i>
                    </a>
                    <div class="dropdown-menu">
                        <a href="../research.html">Overview</a>
                        <div class="dropdown-divider"></div>
                        <a href="alphafold.html" class="active">AlphaFold Analysis</a>
                        <a href="molecular-dynamics.html">Molecular Dynamics</a>
                        <a href="variants.html">Variant Database</a>
                        <a href="pharmacogenomics.html">Pharmacogenomics</a>
                        <div class="dropdown-divider"></div>
                        <a href="ml-discovery.html">ML Drug Discovery</a>
                        <a href="crispr.html">CRISPR Therapeutics</a>
                        <a href="clinical-trials.html">Clinical Trials</a>
                    </div>
                </li>
                <li><a href="https://www.g6pd.ai" target="_blank">G6PD.ai</a></li>
                <li><a href="../community.html">Contact</a></li>
            </ul>
            <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle menu">
                <i data-lucide="menu" style="width: 24px; height: 24px;"></i>
            </button>
        </div>
    </nav>

    <!-- Mobile Navigation -->
    <div class="mobile-nav" id="mobileNav">
        <a href="../about.html">About</a>
        <a href="../research.html">Research</a>
        <a href="https://www.g6pd.ai" target="_blank">G6PD.ai</a>
        <a href="../community.html">Contact</a>
    </div>

    <!-- Hero Section -->
    <section class="alphafold-hero">
        <div class="helix-animation">
            <div class="helix-strand" style="left: 10%; animation-delay: 0s;"></div>
            <div class="helix-strand" style="left: 30%; animation-delay: 0.5s;"></div>
            <div class="helix-strand" style="left: 50%; animation-delay: 1s;"></div>
            <div class="helix-strand" style="left: 70%; animation-delay: 1.5s;"></div>
            <div class="helix-strand" style="left: 90%; animation-delay: 2s;"></div>
        </div>
        <div class="container hero-content">
            <div class="confidence-badge">
                <i data-lucide="brain" style="width: 16px; height: 16px;"></i>
                DeepMind AlphaFold2
            </div>
            <h1 style="font-size: clamp(2rem, 5vw, 3.5rem); margin-bottom: 1rem;">
                G6PD Structure Analysis
            </h1>
            <p style="font-size: 1.1rem; opacity: 0.9; max-width: 600px;">
                Exploring the 3D structure of Glucose-6-Phosphate Dehydrogenase using
                AI-predicted protein folding to understand disease mechanisms.
            </p>
        </div>
    </section>

    <!-- 3D Viewer Section -->
    <section class="section">
        <div class="container">
            <div class="viewer-container fade-in">
                <div class="protein-viewer" id="proteinViewer">
                    <!-- 3Dmol.js viewer will be initialized here -->
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: rgba(255,255,255,0.7);">
                        <div class="loading-spinner" style="width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.1); border-top-color: #4361ee; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
                        <p>Loading G6PD Structure...</p>
                        <p style="font-size: 0.8rem; margin-top: 0.5rem;">UniProt: P11413</p>
                    </div>
                </div>

                <div class="viewer-controls">
                    <button class="view-btn active" onclick="setStyle('cartoon')">
                        <i data-lucide="waves" style="width: 14px; height: 14px;"></i>
                        Cartoon
                    </button>
                    <button class="view-btn" onclick="setStyle('stick')">
                        <i data-lucide="git-branch" style="width: 14px; height: 14px;"></i>
                        Stick
                    </button>
                    <button class="view-btn" onclick="setStyle('sphere')">
                        <i data-lucide="circle" style="width: 14px; height: 14px;"></i>
                        Sphere
                    </button>
                    <button class="view-btn" onclick="setStyle('surface')">
                        <i data-lucide="box" style="width: 14px; height: 14px;"></i>
                        Surface
                    </button>
                    <button class="view-btn" onclick="highlightActiveSite()">
                        <i data-lucide="target" style="width: 14px; height: 14px;"></i>
                        Active Site
                    </button>
                    <button class="view-btn" onclick="highlightMutations()">
                        <i data-lucide="alert-triangle" style="width: 14px; height: 14px;"></i>
                        Mutations
                    </button>
                </div>

                <div class="confidence-scale">
                    <div class="confidence-level very-high">Very High (pLDDT > 90)</div>
                    <div class="confidence-level high">High (70-90)</div>
                    <div class="confidence-level low">Low (50-70)</div>
                    <div class="confidence-level very-low">Very Low (&lt; 50)</div>
                </div>

                <div class="structure-info">
                    <div class="info-card">
                        <div class="info-value">515</div>
                        <div class="info-label">Amino Acids</div>
                    </div>
                    <div class="info-card">
                        <div class="info-value">59.3</div>
                        <div class="info-label">kDa Mass</div>
                    </div>
                    <div class="info-card">
                        <div class="info-value">92.4</div>
                        <div class="info-label">Avg. pLDDT</div>
                    </div>
                    <div class="info-card">
                        <div class="info-value">2</div>
                        <div class="info-label">Domains</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Protein Domains -->
    <section class="section section-alt">
        <div class="container">
            <h2 class="section-title fade-in">Protein Domains</h2>
            <p class="section-subtitle fade-in">
                G6PD consists of two functional domains essential for enzymatic activity
            </p>

            <div class="grid-2" style="margin-top: 2rem;">
                <div class="domain-card fade-in">
                    <div class="domain-header">
                        <div class="domain-name">N-terminal Domain</div>
                        <div class="domain-range">27-200</div>
                    </div>
                    <p style="color: var(--text-light); margin-bottom: 1rem;">
                        Contains the NADP+ binding site (Rossmann fold). This domain is responsible
                        for coenzyme binding and is highly conserved across species.
                    </p>
                    <div>
                        <strong style="font-size: 0.85rem;">Key Residues:</strong>
                        <div style="margin-top: 0.5rem;">
                            <span class="interactive-residue active-site">Lys-171</span>
                            <span class="interactive-residue active-site">Arg-198</span>
                            <span class="interactive-residue active-site">His-201</span>
                            <span class="interactive-residue mutation-site">Ser-188</span>
                        </div>
                    </div>
                </div>

                <div class="domain-card fade-in">
                    <div class="domain-header">
                        <div class="domain-name">C-terminal Domain</div>
                        <div class="domain-range">201-515</div>
                    </div>
                    <p style="color: var(--text-light); margin-bottom: 1rem;">
                        Contains the substrate binding site and dimerization interface.
                        Critical for G6P recognition and catalytic activity.
                    </p>
                    <div>
                        <strong style="font-size: 0.85rem;">Key Residues:</strong>
                        <div style="margin-top: 0.5rem;">
                            <span class="interactive-residue active-site">Asp-258</span>
                            <span class="interactive-residue active-site">His-263</span>
                            <span class="interactive-residue mutation-site">Val-282</span>
                            <span class="interactive-residue mutation-site">Arg-459</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Structural Analysis -->
    <section class="section">
        <div class="container">
            <h2 class="section-title fade-in">Structural Insights</h2>

            <div class="grid-3" style="margin-top: 2rem;">
                <div class="card fade-in">
                    <div class="card-icon" style="background: linear-gradient(135deg, #4361ee, #3730a3);">
                        <i data-lucide="layers" style="width: 24px; height: 24px;"></i>
                    </div>
                    <h3>Dimer Interface</h3>
                    <p>G6PD functions as a homodimer. The interface involves ~2,400 Å² of buried surface area, with key contacts at residues 393-410.</p>
                </div>

                <div class="card fade-in">
                    <div class="card-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                        <i data-lucide="zap" style="width: 24px; height: 24px;"></i>
                    </div>
                    <h3>Catalytic Mechanism</h3>
                    <p>The active site positions G6P and NADP+ for hydride transfer. His-263 acts as the catalytic base in the reaction mechanism.</p>
                </div>

                <div class="card fade-in">
                    <div class="card-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                        <i data-lucide="shield" style="width: 24px; height: 24px;"></i>
                    </div>
                    <h3>Structural NADP+</h3>
                    <p>A second "structural" NADP+ binding site stabilizes the dimer. Loss of this site causes protein instability in many variants.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- AlphaFold Confidence -->
    <section class="section section-alt">
        <div class="container">
            <h2 class="section-title fade-in">Prediction Confidence</h2>
            <p class="section-subtitle fade-in">
                AlphaFold's per-residue confidence scores reveal structural reliability
            </p>

            <div class="viewer-container fade-in" style="margin-top: 2rem;">
                <canvas id="confidenceChart" height="200"></canvas>
            </div>

            <div class="grid-2" style="margin-top: 2rem;">
                <div class="card fade-in">
                    <h3 style="margin-bottom: 1rem;">High Confidence Regions</h3>
                    <ul style="color: var(--text-light); line-height: 1.8;">
                        <li>Core β-sheet structures (pLDDT > 95)</li>
                        <li>α-helices in both domains (pLDDT > 90)</li>
                        <li>Active site residues (pLDDT > 92)</li>
                        <li>Dimer interface contacts (pLDDT > 88)</li>
                    </ul>
                </div>
                <div class="card fade-in">
                    <h3 style="margin-bottom: 1rem;">Lower Confidence Regions</h3>
                    <ul style="color: var(--text-light); line-height: 1.8;">
                        <li>N-terminal signal peptide (1-26)</li>
                        <li>Surface loops (residues 120-135)</li>
                        <li>C-terminal flexible region (500-515)</li>
                        <li>Disordered linker regions</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Methods -->
    <section class="section">
        <div class="container-sm">
            <h2 class="section-title fade-in">Methods & Resources</h2>

            <div class="card fade-in" style="margin-top: 2rem;">
                <h3 style="margin-bottom: 1rem;">Data Sources</h3>
                <div style="display: grid; gap: 1rem;">
                    <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-alt); border-radius: var(--radius);">
                        <div style="width: 40px; height: 40px; background: #0053d6; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                            <span style="color: white; font-weight: bold; font-size: 0.8rem;">AF</span>
                        </div>
                        <div>
                            <strong>AlphaFold Database</strong>
                            <p style="font-size: 0.85rem; color: var(--text-light);">AF-P11413-F1 (Human G6PD)</p>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-alt); border-radius: var(--radius);">
                        <div style="width: 40px; height: 40px; background: #15803d; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                            <span style="color: white; font-weight: bold; font-size: 0.8rem;">UP</span>
                        </div>
                        <div>
                            <strong>UniProt</strong>
                            <p style="font-size: 0.85rem; color: var(--text-light);">P11413 - G6PD_HUMAN</p>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-alt); border-radius: var(--radius);">
                        <div style="width: 40px; height: 40px; background: #dc2626; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                            <span style="color: white; font-weight: bold; font-size: 0.8rem;">PDB</span>
                        </div>
                        <div>
                            <strong>Protein Data Bank</strong>
                            <p style="font-size: 0.85rem; color: var(--text-light);">6E08, 2BHL (experimental structures)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div>
                <div class="footer-brand">
                    <div class="logo-icon">G6</div>
                    <span style="font-weight: 700;">G6PD Research</span>
                </div>
                <p class="footer-description">
                    Advancing G6PD deficiency research through computational biology
                    and emerging therapeutics.
                </p>
            </div>

            <div>
                <h4 class="footer-title">Research</h4>
                <ul class="footer-links">
                    <li><a href="alphafold.html">AlphaFold</a></li>
                    <li><a href="molecular-dynamics.html">Molecular Dynamics</a></li>
                    <li><a href="variants.html">Variant Database</a></li>
                    <li><a href="crispr.html">CRISPR</a></li>
                </ul>
            </div>

            <div>
                <h4 class="footer-title">Connect</h4>
                <ul class="footer-links">
                    <li><a href="../about.html">About Luke</a></li>
                    <li><a href="https://www.g6pd.ai" target="_blank">G6PD.ai</a></li>
                    <li><a href="../community.html">Contact</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>© 2024 G6PD Research Initiative by Luke Chen. All rights reserved.</p>
        </div>
    </footer>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Navigation scroll effect
        const navbar = document.getElementById('navbar');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileNav = document.getElementById('mobileNav');
        mobileMenuBtn.addEventListener('click', () => {
            mobileNav.classList.toggle('active');
        });

        // Intersection Observer for animations
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

        // Confidence Chart
        const ctx = document.getElementById('confidenceChart').getContext('2d');

        // Generate realistic pLDDT data
        const residues = [];
        const plddt = [];
        for (let i = 1; i <= 515; i++) {
            residues.push(i);
            // Simulate realistic confidence pattern
            let confidence;
            if (i < 27) {
                confidence = 40 + Math.random() * 20; // Signal peptide - low
            } else if (i >= 120 && i <= 135) {
                confidence = 60 + Math.random() * 15; // Loop region
            } else if (i >= 500) {
                confidence = 55 + Math.random() * 20; // C-terminal
            } else {
                confidence = 85 + Math.random() * 12; // Core structure - high
            }
            plddt.push(Math.min(100, confidence));
        }

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: residues,
                datasets: [{
                    label: 'pLDDT Score',
                    data: plddt,
                    borderColor: '#4361ee',
                    backgroundColor: 'rgba(67, 97, 238, 0.1)',
                    fill: true,
                    tension: 0.3,
                    pointRadius: 0,
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            title: (items) => `Residue ${items[0].label}`,
                            label: (item) => `pLDDT: ${item.raw.toFixed(1)}`
                        }
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Residue Position'
                        },
                        ticks: {
                            maxTicksLimit: 10
                        }
                    },
                    y: {
                        min: 0,
                        max: 100,
                        title: {
                            display: true,
                            text: 'pLDDT Score'
                        }
                    }
                }
            }
        });

        // View style buttons
        function setStyle(style) {
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.view-btn').classList.add('active');
            console.log('Setting style to:', style);
            // In production, this would update the 3Dmol viewer
        }

        function highlightActiveSite() {
            console.log('Highlighting active site residues');
        }

        function highlightMutations() {
            console.log('Highlighting mutation sites');
        }

        // Initialize 3Dmol viewer
        document.addEventListener('DOMContentLoaded', function() {
            let viewer = $3Dmol.createViewer('proteinViewer', {
                backgroundColor: 'rgb(15, 15, 35)'
            });

            // Load G6PD structure from AlphaFold
            $3Dmol.download('pdb:2BHL', viewer, {}, function() {
                viewer.setStyle({}, {cartoon: {color: 'spectrum'}});
                viewer.zoomTo();
                viewer.render();
                viewer.spin('y', 0.5);
            });
        });
    </script>
</body>
</html>
